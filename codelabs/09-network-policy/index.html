
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>CKAD Exam Readiness Tasks</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="../../claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
  <script async src="../../scripts/code-block-copy.js"></script>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="09-network-policy"
                  title="CKAD Exam Readiness Tasks"
                  environment="web"
                  feedback-link="https://github.com/piouson/kubernetes-bootcamp/discussions">
    
      <google-codelab-step label="Ingress" duration="12">
        <h2 is-upgraded>Prerequisites</h2>
<ol type="1">
<li>Single-node Kubernetes cluster (e.g. <code>minikube start</code>)</li>
<li><strong>kubectl</strong> installed or alias created</li>
<li><strong>ingress-controller</strong> installed in your cluster <ul>
<li>if you have <strong>minikube</strong> installed, the <strong>ingress</strong> addon will be auto enabled</li>
<li>otherwise, you should manually install an <strong>ingress-controller</strong> in your cluster</li>
</ul>
</li>
</ol>
<h2 is-upgraded>Scenario</h2>
<p>An intern, who looks up to you as a role model, has messaged you for help after struggling with Kubernetes for a few days:</p>
<aside class="special"><p> I created a <code>bat</code> namespace and done everything in there, but still cannot access the app locally at <code>http://ckad-bootcamp.local</code>. I think I messed up the ingress configuration, please stop by when you have time, I could use a hand! </p>
</aside>
<h2 is-upgraded>Goal</h2>
<p>Curious, you decided to connect remotely to the cluster the intern was working on, to figure out what the intern had been up to, and show the intern what a true role model you are!</p>
<p>Resolve the intern&#39;s issue without creating any new resources and without leaving your desk! You may create a temporary pod to test connectivity.</p>
<h3 is-upgraded>Setup environment</h3>
<pre><code language="language-sh" class="language-sh">curl -s https://raw.githubusercontent.com/piouson/kubernetes-codelabs/main/lab-files/task-09-ingress-create.sh | bash
</code></pre>
<h3 is-upgraded>Destroy environment</h3>
<pre><code language="language-sh" class="language-sh">curl -s https://raw.githubusercontent.com/piouson/kubernetes-codelabs/main/lab-files/task-09-ingress-destroy.sh | bash
</code></pre>
<h3 is-upgraded>Hints</h3>
<details>
<summary>Click to reveal hints</summary>
<details>
<summary>Namespace (1/18)</summary>
<p>Have you confirmed the Namespace and resources in it?</p>
</details>
<details>
<summary>Ingress I (2/18)</summary>
<p>Does an Ingress resource exist in the Namespace?</p>
</details>
<details>
<summary>Ingress II (3/18)</summary>
<p>Have you confirmed the Ingress configuration?</p>
</details>
<details>
<summary>Ingress III (4/18)</summary>
<p>What is a critical prerequisite for a cluster to use Ingress?</p>
</details>
<details>
<summary>Ingress IV (5/18)</summary>
<p>What is the role of an IngressClass?</p>
</details>
<details>
<summary>Ingress V (6/18)</summary>
<p>What backends are defined in the Ingress paths?</p>
</details>
<details>
<summary>Service I (7/18)</summary>
<p>Have you confirmed the Service configuration?</p>
</details>
<details>
<summary>Service II (8/18)</summary>
<p>Can you reach the application via DNS using the Service name?</p>
</details>
<details>
<summary>Service III (9/18)</summary>
<p>Does the Service have Endpoints defined?</p>
</details>
<details>
<summary>Pod I (10/18)</summary>
<p>Can you reach the application via the Endpoints?</p>
</details>
<details>
<summary>Pod II (11/18)</summary>
<p>Is there really an application running in the Pods?</p>
</details>
<details>
<summary>Pod III (12/18)</summary>
<p>What port is the application running on?</p>
</details>
<details>
<summary>Service IV (13/18)</summary>
<p>Does the Service correctly target the Pods?</p>
</details>
<details>
<summary>Service V (14/18)</summary>
<p>Does the Service target the correct container ports in the Pods?</p>
</details>
<details>
<summary>Ingress VI (15/18)</summary>
<p>Did you setup a local name-based virtual host <code>ckad-bootcamp.local</code>?</p>
<p>You should add the Hostname-IP mapping in <code>/etc/hosts</code>:</p>
<pre><code language="language-sh" class="language-sh">kubectl get nodes -o wide
echo &#34;$NODE_INTERNAL_IP ckad-bootcamp.local&#34; | sudo tee -a /etc/hosts
</code></pre>
</details>
<details>
<summary>Service VI (16/18)</summary>
<p>What type of Service can be used locally with name-based virtual hosts?</p>
</details>
<details>
<summary>Ingress VII (17/18)</summary>
<p>Is it possible to reach the app locally via <code>http://ckad-bootcamp.local</code>?</p>
<p>No, not without a reverse proxy. You must specify a port <code>http://ckad-bootcamp.local:$NODE_PORT</code></p>
</details>
<details>
<summary>Reverse Proxy (optional) (18/18)</summary>
<p>For practice, lets create a reverse proxy locally using Nginx, that will redirect all requests for the root path <code>/</code> to our desired path.</p>
<p>In this case, we want requests to <code>http://ckad-bootcamp.local</code> redirected to <code>http://ckad-bootcamp.local:$NODE_PORT</code></p>
<pre><code language="language-sh" class="language-sh">mkdir nginx-conf
cat &lt;&lt;EOF &gt;nginx-conf/nginx.conf
server {
  listen 80;
  location / {
    proxy_pass http://$NODE_IP:$NODE_PORT;
  }
}
EOF
docker run --name nginx --volume ./nginx-conf:/etc/nginx/conf.d -d nginx
curl http://ckad-bootcamp.local # now works without adding node port
</code></pre>
</details>
</details>


      </google-codelab-step>
    
      <google-codelab-step label="Network Policy" duration="12">
        

      </google-codelab-step>
    
  </google-codelab>

  <script src="../../claat-public/native-shim.js"></script>
  <script src="../../claat-public/custom-elements.min.js"></script>
  <script src="../../claat-public/prettify.js"></script>
  <script src="../../claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
